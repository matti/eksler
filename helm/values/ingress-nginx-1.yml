# https://github.com/kubernetes/ingress-nginx/blob/main/charts/ingress-nginx/values.yaml

controller:
  nodeSelector:
    ingress: "yes"

  autoscaling:
    enabled: true
    minReplicas: 3
    maxReplicas: 12
    targetCPUUtilizationPercentage: 50
    targetMemoryUtilizationPercentage: 50

  resources:
    limits:
      cpu: 1
      memory: 128Mi
    requests:
      cpu: 1
      memory: 128Mi

  tolerations:
    - key: node.kubernetes.io/not-ready
      operator: Exists
      effect: NoExecute
      tolerationSeconds: 10
    - key: node.kubernetes.io/unreachable
      operator: Exists
      effect: NoExecute
      tolerationSeconds: 10

  affinity:
    podAntiAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        - labelSelector:
            matchExpressions:
              - key: "app.kubernetes.io/name"
                operator: In
                values: #TODO: is this the name?
                  - "ingress-nginx"
          topologyKey: "kubernetes.io/hostname"

  # https://github.com/kubernetes/ingress-nginx/issues/8175
  service:
    ipFamilyPolicy:
    ipFamilies:

    annotations:
      service.beta.kubernetes.io/aws-load-balancer-type: "external"
      service.beta.kubernetes.io/aws-load-balancer-scheme: "internet-facing"
      service.beta.kubernetes.io/aws-load-balancer-ip-address-type: "dualstack"
      # ValidationError: Target type 'instance' is not supported with an IPv6 target group
      service.beta.kubernetes.io/aws-load-balancer-nlb-target-type: "ip"
